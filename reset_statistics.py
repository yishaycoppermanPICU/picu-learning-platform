#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
××™×¤×•×¡ ×¡×˜×˜×™×¡×˜×™×§×” - ××—×™×§×ª ×›×œ ×”××©×ª××©×™× ×•×”× ×ª×•× ×™× ××”××¢×¨×›×ª
"""

from utils.database import init_supabase

def reset_statistics():
    """××—×™×§×ª ×›×œ ×”× ×ª×•× ×™× ×”×¡×˜×˜×™×¡×˜×™×™×"""
    
    print("ğŸ”„ ××ª×—×‘×¨ ×œ××¡×“ ×”× ×ª×•× ×™×...")
    supabase = init_supabase()
    
    if not supabase:
        print("âŒ ×©×’×™××” ×‘×—×™×‘×•×¨ ×œ××¡×“ × ×ª×•× ×™×")
        return False
    
    print("âœ… ×—×™×‘×•×¨ ×”×¦×œ×™×—!")
    
    # ××™×©×•×¨ ××”××©×ª××©
    print("\nâš ï¸  ×¤×¢×•×œ×” ×–×• ×ª××—×§ ××ª ×›×œ ×”× ×ª×•× ×™× ×”×‘××™×:")
    print("   - ×›×œ ×”××©×ª××©×™×")
    print("   - ×›×œ ×ª×•×¦××•×ª ×”××‘×—× ×™×")
    print("   - ×›×œ × ×ª×•× ×™ ×”×”×©×œ××•×ª ×”×©×‘×•×¢×™×•×ª")
    print("   - ×›×œ ×”×¡×˜×˜×™×¡×˜×™×§×•×ª")
    
    confirm = input("\nâ“ ×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”××©×™×š? (×›×ª×•×‘ 'yes' ×œ××™×©×•×¨): ")
    
    if confirm.lower() != 'yes':
        print("âŒ ×”×¤×¢×•×œ×” ×‘×•×˜×œ×”")
        return False
    
    try:
        print("\nğŸ—‘ï¸  ××•×—×§ × ×ª×•× ×™×...")
        
        # ××—×™×§×ª ×ª×•×¦××•×ª ××‘×—× ×™×
        print("   â†’ ××•×—×§ ×ª×•×¦××•×ª ××‘×—× ×™×...")
        try:
            result = supabase.table('quiz_results').delete().neq('id', '00000000-0000-0000-0000-000000000000').execute()
            print(f"   âœ… × ××—×§×• ×ª×•×¦××•×ª ××‘×—× ×™×")
        except Exception as e:
            print(f"   âš ï¸  ×œ× × ××¦××” ×˜×‘×œ×ª quiz_results (×–×” ×‘×¡×“×¨)")
        
        # ××—×™×§×ª ××©×ª××©×™×
        print("   â†’ ××•×—×§ ××©×ª××©×™×...")
        try:
            result = supabase.table('users').delete().neq('id', '00000000-0000-0000-0000-000000000000').execute()
            deleted = len(result.data) if result.data else 0
            print(f"   âœ… × ××—×§×• {deleted} ××©×ª××©×™×")
        except Exception as e:
            print(f"   âš ï¸  ×©×’×™××” ×‘××—×™×§×ª ××©×ª××©×™×: {str(e)}")
        
        print("\n" + "="*50)
        print("âœ¨ ××™×¤×•×¡ ×”×¡×˜×˜×™×¡×˜×™×§×” ×”×•×©×œ× ×‘×”×¦×œ×—×”!")
        print("="*50)
        print("\nğŸ’¡ ×”××¢×¨×›×ª ×›×¢×ª × ×§×™×™×” ×•××•×›× ×” ×œ×©×™××•×© ×××©×™.")
        print("   × ×™×ª×Ÿ ×œ×”×ª×—×™×œ ×××¤×¡ ×¢× × ×ª×•× ×™× ×××™×ª×™×™×.")
        
        return True
        
    except Exception as e:
        print(f"\nâŒ ×©×’×™××” ×›×œ×œ×™×ª: {str(e)}")
        return False

if __name__ == "__main__":
    print("="*50)
    print("ğŸ”„ ××™×¤×•×¡ ×¡×˜×˜×™×¡×˜×™×§×” ×©×œ ×”××¢×¨×›×ª")
    print("="*50)
    
    success = reset_statistics()
    
    if success:
        print("\nğŸ‰ ×”××™×¤×•×¡ ×”×•×©×œ× ×‘×”×¦×œ×—×”!")
    else:
        print("\nâš ï¸  ×”××™×¤×•×¡ ×œ× ×”×•×©×œ×")
