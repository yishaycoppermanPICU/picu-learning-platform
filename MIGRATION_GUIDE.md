# מדריך העברה למסד נתונים

## 📋 סקירה כללית

מערכת PICU Learning Platform עוברת ממערכת אחסון מבוססת JSON לבסיס נתונים מתקדם (Supabase/PostgreSQL).

**יתרונות המעבר:**
- ✏️ עריכה קלה יותר דרך ממשק גרפי
- 📑 יכולת להוסיף subsections באופן דינמי
- 🏷️ תיוג מתקדם לחיפוש וסינון
- ❓ ניהול שאלות quiz משויכות לתוכן
- 📊 מעקב גרסאות וסטטיסטיקות

---

## 🚀 שלב 1: יצירת הטבלאות ב-Supabase

1. פתח את Supabase Dashboard:  
   👉 https://xdzpnlqzlopxgktltvif.supabase.co

2. לחץ על **SQL Editor** בתפריט השמאלי (אייקון </>)

3. לחץ על **New Query** (או `+ New query`)

4. פתח את הקובץ `create_tables.sql` והעתק את **כל התוכן**

5. הדבק ב-SQL Editor

6. לחץ **RUN** (או `Ctrl+Enter`)

7. בדוק שהכל עבר בהצלחה:
   - אמור להופיע: ✅ "Success. No rows returned"
   - אם יש שגיאה, העתק אותה והדבק לפתרון

---

## ✅ שלב 2: וודא שהטבלאות נוצרו

1. לחץ על **Table Editor** בתפריט השמאלי (אייקון 📊)

2. בדוק שרואה את הטבלאות הבאות:
   - ✅ `content_items` - פריטי תוכן ראשיים
   - ✅ `content_sections` - מקטעי משנה
   - ✅ `quiz_questions` - שאלות quiz
   - ✅ `users` - משתמשים
   - ✅ `institutions` - מוסדות
   - ✅ `quiz_results` - תוצאות quiz

3. בדוק את החיבור מהקוד:
```bash
python3 test_connection.py
```

צריך לראות: ✅ "החיבור הצליח!"

---

## 📝 שלב 3: הזן תוכן למסד הנתונים

**⚠️ חשוב: אל תריץ את `migrate_content.py`**  
התוכן ב-JSON לא מדויק מספיק.

במקום זה, השתמש בעמוד החדש **"עורך מסד נתונים"**:

1. הרץ את האפליקציה:
```bash
streamlit run app.py
```

2. התחבר למערכת עם משתמש עורך

3. עבור לעמוד **"🗄️ עורך מסד נתונים"** (עמוד 8)

4. צור פריטי תוכן חדשים:
   - לחץ על "צור חדש"
   - מלא את הפרטים (כותרת, קטגוריה, תיאור וכו')
   - הוסף מקטעים (sections) לכל פריט
   - שמור

5. או - שלח לי טקסט והעתק אותו במדויק

---

## 🎯 מה עכשיו?

אחרי שהטבלאות נוצרו, יש לך שתי אפשרויות:

### אפשרות 1: הזן תוכן בעצמך
- השתמש בעמוד "עורך מסד נתונים"
- צור פריטי תוכן אחד אחד
- הוסף מקטעים ושאלות quiz

### אפשרות 2: תן לי להעתיק תוכן
- שלח לי טקסט עם התוכן המדויק
- אני אעתיק אותו במדויק למסד הנתונים
- אשתמש ב-API או בסקריפט ייעודי

---

## 🆘 פתרון בעיות

### השגיאה: "Could not find the table"
הטבלאות עדיין לא נוצרו. חזור לשלב 1.

### השגיאה: "Failed to initialize Supabase"
בעיה בחיבור. בדוק:
- חיבור אינטרנט
- URL נכון: `https://xdzpnlqzlopxgktltvif.supabase.co`
- API Key תקין

### לא רואה את העמוד "עורך מסד נתונים"
הרענן את העמוד או הפעל מחדש:
```bash
streamlit run app.py
```

---

## 📞 צריך עזרה?

אם נתקעת בשלב כלשהו, העתק את השגיאה המדויקת ואני אעזור לפתור!
